
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificates - EventHub</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="certificates.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Additional styles for API functionality -->
    <style>
         * {
    user-select: text !important;
    -webkit-user-select: text !important;
    -ms-user-select: text !important;
    -moz-user-select: text !important;
  }
        body{
            user-select: text !important;
            font-family: 'Outfit', sans-serif;
        }
        .certificate-card {
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
            border-radius: 8px;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .certificate-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .certificate-card .card-body {
            padding: 1.5rem;
        }
        .certificate-card .card-title {
            color: #4e73df;
            margin-bottom: 1rem;
        }
        .certificate-code {
            font-family: monospace;
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
        }
        .no-certificates {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }
        .no-certificates i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #dee2e6;
        }
        .search-btn {
            width: 100%;
            padding: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
<nav style="
  position: fixed;
  top: 0;
  width: 100%;
  background: white;
  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
  z-index: 9999;
  padding: 0 20px;
  height: 70px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-family: 'Outfit', sans-serif;
">


  <!-- Logo -->
  <div style="
    font-size: 1.8rem;
    font-weight: 700;
    color: #6366f1;
  "> <img src="https://i.ibb.co/mFHfq6KS/Event-Hub-Logo.jpg" alt="Logo" style="height: 60px; margin-top: 5%;"></div>

  <!-- Hamburger -->
  <div id="hamburgerBtn" style="
    display: none;
    flex-direction: column;
    cursor: pointer;
  " onclick="toggleNavMenu()">
    <div style="width: 25px; height: 3px; background: #1f2937; margin: 3px 0;"></div>
    <div style="width: 25px; height: 3px; background: #1f2937; margin: 3px 0;"></div>
    <div style="width: 25px; height: 3px; background: #1f2937; margin: 3px 0;"></div>
  </div>

  <!-- Nav Menu -->
  <div id="navMenu" style="
    display: flex;
    gap: 2rem;
    list-style: none;
    align-items: center;
  ">
    <a href="index.html" style="text-decoration: none; color: #1f2937; font-weight: 500;">Home</a>
    <a href="events.html" style="text-decoration: none; color: #1f2937; font-weight: 500;">Events</a>
    <a href="certificates.html" style="text-decoration: none; color: #1f2937; font-weight: 650;">Certificates</a>
    <a href="results.html" style="text-decoration: none; color: #1f2937; font-weight: 500;">Results</a>
    <a href="Intern.html" style="text-decoration: none; color: #1f2937; font-weight: 500;">Internships</a>
    <a href="refer.html" style="text-decoration: none; color: #1f2937; font-weight: 500;">Referral</a>
    <a href="1.html" style="text-decoration: none; color: #1f2937; font-weight: 500;">Profile</a>
    <!-- Login and Logout -->
    <a id="loginItem" href="Login.html" style="
      text-decoration: none;
      background: #6366f1;
      color: white;
      padding: 0.5rem 1.2rem;
      border-radius: 8px;
      font-weight: 600;
    ">Login</a>

    <a id="logoutItem" href="#" onclick="logoutUser()" style="
      text-decoration: none;
      background: #f46721;
      color: white;
      padding: 0.5rem 1.2rem;
      border-radius: 8px;
      font-weight: 600;
      display: none;
    ">Logout</a>
  </div>
  </div>
</nav>

              

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Download Certificates</h1>
            <p>Get your participation and achievement certificates instantly</p>
        </div>
    </section>

    <!-- Certificate Download Section -->
    <section class="certificate-section">
        <div class="container">
            <div class="certificate-container">
                <div class="certificate-form-section">
                    <div class="form-header">
                        <i class="fas fa-certificate"></i>
                        <h2>Certificate Lookup</h2>
                        <p>Enter your details to find and download your certificates</p>
                    </div>

                    <form id="certificate-form" class="certificate-form">
                        <div class="form-group">
                            <label for="participant-name">Full Name</label>
                            <input type="text" id="participant-name" name="participant-name" required 
                                   placeholder="Enter your full name as registered">
                        </div>

                        <div class="form-group">
                            <label for="participant-email">Email Address</label>
                            <input type="email" id="participant-email" name="participant-email" required 
                                   placeholder="Enter your registered email address">
                        </div>

                        <div class="form-group">
                            <label for="certificate-code">Certificate Code (Optional)</label>
                            <input type="text" id="certificate-code" name="certificate-code"
                                   placeholder="Enter your certificate code if you have one">
                        </div>

                        <button type="submit" class="btn btn-primary search-btn">
                            <i class="fas fa-search"></i>
                            Find My Certificates
                        </button>
                        <center>
  <a href="VerifyCertificate.html" class="btn btn-outline-primary">
    <i class="bi bi-patch-check-fill me-2"></i>Verify Certificate
  </a>
</center>


                    </form>
                </div>

                <div class="certificate-preview-section">
                    <div class="preview-header">
                        <h3>Certificate Preview</h3>
                        <p>Your certificates will appear here</p>
                    </div>
                    
                    <div id="certificate-results" class="certificate-results">
                        <div class="no-certificates">
                            <i class="fas fa-certificate"></i>
                            <h4>No Certificates Found</h4>
                            <p>Enter your details to search for certificates</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sample Certificates Section -->
    <section class="sample-certificates">
        <div class="container">
            <h2 class="section-title">Sample Certificates</h2>
            <p class="section-subtitle">See examples of certificates you can earn by participating in our events</p>
            
            <div class="samples-grid">
                <div class="sample-card">
                    <div class="sample-image">
                        <div class="certificate-template participation">
                            <div class="cert-header">
                                <h3>CERTIFICATE OF PARTICIPATION</h3>
                                <div class="cert-logo">EventHub</div>
                            </div>
                            <div class="cert-content">
                                <p class="cert-text">This is to certify that</p>
                                <h4 class="cert-name">[Participant Name]</h4>
                                <p class="cert-text">has successfully participated in</p>
                                <h5 class="cert-event">[Event Name]</h5>
                                <p class="cert-date">Date: [Event Date]</p>
                            </div>
                            <div class="cert-footer">
                                <div class="signature">
                                    <p>Event Organizer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <h4>Participation Certificate</h4>
                    <p>Awarded to all participants who complete an event</p>
                </div>

                <div class="sample-card">
                    <div class="sample-image">
                        <div class="certificate-template achievement">
                            <div class="cert-header">
                                <h3>CERTIFICATE OF ACHIEVEMENT</h3>
                                <div class="cert-logo">EventHub</div>
                            </div>
                            <div class="cert-content">
                                <p class="cert-text">This is to certify that</p>
                                <h4 class="cert-name">[Participant Name]</h4>
                                <p class="cert-text">has achieved</p>
                                <h5 class="cert-achievement">1st Place</h5>
                                <p class="cert-text">in</p>
                                <h5 class="cert-event">[Event Name]</h5>
                                <p class="cert-date">Date: [Event Date]</p>
                            </div>
                            <div class="cert-footer">
                                <div class="signature">
                                    <p>Event Organizer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <h4>Achievement Certificate</h4>
                    <p>Awarded to winners and top performers</p>
                </div>

                <div class="sample-card">
                    <div class="sample-image">
                        <div class="certificate-template completion">
                            <div class="cert-header">
                                <h3>CERTIFICATE OF COMPLETION</h3>
                                <div class="cert-logo">EventHub</div>
                            </div>
                            <div class="cert-content">
                                <p class="cert-text">This is to certify that</p>
                                <h4 class="cert-name">[Participant Name]</h4>
                                <p class="cert-text">has successfully completed</p>
                                <h5 class="cert-event">[Workshop/Course Name]</h5>
                                <p class="cert-text">with a score of</p>
                                <h5 class="cert-score">95%</h5>
                                <p class="cert-date">Date: [Completion Date]</p>
                            </div>
                            <div class="cert-footer">
                                <div class="signature">
                                    <p>Event Organizer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <h4>Completion Certificate</h4>
                    <p>Awarded for completing workshops and courses</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Instructions Section -->
    <section class="instructions-section">
        <div class="container">
            <h2 class="section-title">How to Download Your Certificate</h2>
            <div class="instructions-grid">
                <div class="instruction-card">
                    <div class="instruction-icon">
                        <i class="fas fa-user-edit"></i>
                    </div>
                    <h3>Step 1: Enter Details</h3>
                    <p>Fill in your full name and email address exactly as you registered for the event.</p>
                </div>
                
                <div class="instruction-card">
                    <div class="instruction-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3>Step 2: Search</h3>
                    <p>Click "Find My Certificates" to search for all certificates associated with your details.</p>
                </div>
                
                <div class="instruction-card">
                    <div class="instruction-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <h3>Step 3: Download</h3>
                    <p>Select and download your certificates in high-quality PDF format.</p>
                </div>
                
                <div class="instruction-card">
                    <div class="instruction-icon">
                        <i class="fas fa-share-alt"></i>
                    </div>
                    <h3>Step 4: Share</h3>
                    <p>Share your achievements on social media or add them to your professional profile.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>EventHub</h3>
                    <p>Your premier platform for organizing and participating in educational and competitive events.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="certificates.html">Certificates</a></li>
                        <li><a href="results.html">Results</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <p><i class="fas fa-envelope"></i> info@eventhub.com</p>
                    <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 EventHub. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Disable right-click context menu
document.addEventListener('contextmenu', e => e.preventDefault());

// Disable specific key shortcuts
document.addEventListener('keydown', function(e) {
  if (
    e.key === 'F12' ||
    (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key.toUpperCase())) ||
    (e.ctrlKey && ['U', 'S', 'P'].includes(e.key.toUpperCase()))
  ) {
    e.preventDefault();
    
  }
});

         const user = localStorage.getItem("user");

    if (user) {
      document.getElementById("logoutItem").style.display = "block";
      document.getElementById("loginItem").style.display = "none";
    } else {
      document.getElementById("logoutItem").style.display = "none";
      document.getElementById("loginItem").style.display = "block";
    }

        function logout() {
  localStorage.clear(); // Clears all localStorage keys
  window.location.href = "Login.html"; // Redirect to login/home page
}
        const API_BASE_URL = 'https://eventdb.onrender.com/api';
       let currentToken = localStorage.getItem('jWtToken');
        // Reusable request function
        async function makeRequest(method, endpoint, data = null, requiresAuth = true) {
            const headers = { 'Content-Type': 'application/json' };
            if (requiresAuth && currentToken) {
                headers['Authorization'] = `Bearer ${currentToken}`;
            }

            const options = { method, headers };
            if (data) options.body = JSON.stringify(data);

            try {
                const response = await fetch(`${API_BASE_URL}${endpoint}`, options);
                const contentType = response.headers.get('content-type');
                const result = contentType && contentType.includes('application/json') ? await response.json() : await response.text();

                if (!response.ok) {
                    throw new Error(result.error || result.message || 'Request failed');
                }

                return result;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        // Display certificates in the results area
        function displayCertificates(certificates, containerId) {
            const container = document.getElementById(containerId);
            
            if (!Array.isArray(certificates)) {
                certificates = [certificates]; // Handle single certificate case
            }

            if (certificates.length === 0) {
                container.innerHTML = `
                    <div class="no-certificates">
                        <i class="fas fa-certificate"></i>
                        <h4>No Certificates Found</h4>
                        <p>No certificates were found matching your search criteria</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = '';
            
            certificates.forEach(cert => {
                const card = document.createElement('div');
                card.className = 'card certificate-card';
                card.innerHTML = `
                   <div class="card-body" style="font-family: 'Outfit', sans-serif;">
  <h5 class="card-title">
    <i class="fas fa-award"></i> ${cert.event_title}
  </h5>
  <p class="card-text"><strong>Type:</strong> ${cert.event_type}</p>
  <p class="card-text"><strong>Participant:</strong> ${cert.participant_name}</p>
  <p class="card-text"><strong>Issued At:</strong> ${new Date(cert.issued_at).toLocaleString()}</p>
  <p class="card-text">
    <strong>Code:</strong>
    <span id="certCode-${cert.id}" style="font-family: monospace;">${cert.unique_code}</span>
    <button style="
      margin-left: 10px;
      padding: 4px 10px;
      font-size: 0.875rem;
      border-radius: 6px;
      border: 1px solid #6c757d;
      background: white;
      color: #6c757d;
      cursor: pointer;
    " onclick="navigator.clipboard.writeText(document.getElementById('certCode-${cert.id}').innerText).then(() => alert('Code copied!'))">
      <i class="fas fa-copy"></i> Copy
    </button>
  </p>
  <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
    <a href="${cert.certificate_url}" target="_blank" style="
      padding: 8px 16px;
      background: #6366f1;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: 600;
    ">
      <i class="fas fa-download" style="margin-right: 6px;"></i> Download Certificate
    </a>
  </div>
</div>

                `;
                container.appendChild(card);
            });
        }

      document.getElementById('certificate-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const name = document.getElementById('participant-name').value.trim();
    const email = document.getElementById('participant-email').value.trim();
    const code = document.getElementById('certificate-code').value.trim();
    
    const resultsContainer = document.getElementById('certificate-results');
    resultsContainer.innerHTML = '<center><div class="text-center py-4"><i class="fas fa-spinner fa-spin fa-2x"></i><p>Searching for certificates...</p></div></center>';
    
    try {
        let certificates;

        if (code) {
            // Search by certificate code
            certificates = await makeRequest('GET', `/certificates/${code}`);
        } else if (email) {
            // Search by email
            const response = await makeRequest('GET', `/email/${encodeURIComponent(email)}`);


// Extract certificates from the events
certificates = response.events
  .filter(e => e.certificate)
  .map(e => ({
    event_title: e.event.title,
    event_type: e.event.type,
    participant_name: response.user.name,
    issued_at: e.certificate.issuedAt,
    unique_code: e.certificate.uniqueCode,
    certificate_url: e.certificate.url
  }));
        } else {
            // Fallback to all certificates and filter manually
            certificates = await makeRequest('GET', '/certificates');

            if (name) {
                certificates = certificates.filter(cert => 
                    cert.participant_name.toLowerCase().includes(name.toLowerCase())
                );
            }
        }

        displayCertificates(certificates, 'certificate-results');
    } catch (error) {
        resultsContainer.innerHTML = `
            <div class="alert alert-danger">
                <i class="fas fa-exclamation-circle"></i> Error: ${error.message}
            </div>
        `;
    }
});


        // Load certificates on page load if token exists
        document.addEventListener('DOMContentLoaded', async function() {
            if (currentToken) {
                try {
                    console.log('Loading certificates for token:', currentToken);
                } catch (error) {
                    console.error('Could not load certificates:', error);
                }
            }
        });
        function logout() {
  localStorage.clear(); // Clears all localStorage keys
  window.location.href = "Login.html"; // Redirect to login/home page
}

function toggleNavMenu() {
    const navMenu = document.getElementById('navMenu');
    navMenu.style.left = navMenu.style.left === '0px' ? '-100%' : '0px';
  }

  function handleResize() {
    const hamburger = document.getElementById('hamburgerBtn');
    const navMenu = document.getElementById('navMenu');
    if (window.innerWidth <= 768) {
      hamburger.style.display = 'flex';
      navMenu.style.position = 'fixed';
      navMenu.style.left = '-100%';
      navMenu.style.top = '70px';
      navMenu.style.width = '100%';
      navMenu.style.background = 'white';
      navMenu.style.flexDirection = 'column';
      navMenu.style.textAlign = 'center';
      navMenu.style.padding = '2rem 0';
      navMenu.style.transition = 'left 0.3s ease';
      navMenu.style.boxShadow = '0 10px 27px rgba(0, 0, 0, 0.05)';
    } else {
      hamburger.style.display = 'none';
      navMenu.removeAttribute('style');
      navMenu.style.display = 'flex';
      navMenu.style.gap = '2rem';
      navMenu.style.listStyle = 'none';
      navMenu.style.alignItems = 'center';
    }
  }

  function logoutUser() {
    localStorage.removeItem("user");
    window.location.href = "Login.html";
  }

  document.addEventListener("DOMContentLoaded", () => {
    const user = localStorage.getItem("user");
    if (user) {
      document.getElementById("logoutItem").style.display = "block";
      document.getElementById("loginItem").style.display = "none";
    } else {
      document.getElementById("logoutItem").style.display = "none";
      document.getElementById("loginItem").style.display = "block";
    }
    handleResize();
  });

  window.addEventListener('resize', handleResize);
    </script>
</body>
</html>
